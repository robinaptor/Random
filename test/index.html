<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>XP Search & Game</title>
  <link rel="stylesheet" href="https://unpkg.com/xp.css">

  <style>
    body {
      font-family: monospace;
      background-color: #008080;
      min-height: 100vh;
      display: flex;
      justify-content: center;
      align-items: center;
      padding: 1rem;
    }

    .window {
      width: 520px;
      max-width: 100%;
    }

    .rainbow-text {
      font-size: 2.2rem;
      font-weight: bold;
      text-align: center;
      margin: 0.5rem 0 1rem;
      background: linear-gradient(270deg, red, orange, yellow, green, cyan, blue, violet);
      background-size: 1400% 1400%;
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      animation: rainbow 8s ease infinite;
    }

    @keyframes rainbow {
      0% { background-position: 0% 50%; }
      50% { background-position: 100% 50%; }
      100% { background-position: 0% 50%; }
    }

    #searchInput {
      width: 100%;
      font-size: 1rem;
      padding: 0.5em;
      margin-bottom: 1rem;
    }

    .btn-center {
      display: flex;
      justify-content: center;
      gap: 0.5rem;
      margin-bottom: 1rem;
      flex-wrap: wrap;
    }

    #log {
      background: white;
      border: 1px solid #ccc;
      height: 80px;
      overflow-y: auto;
      font-size: 0.9rem;
      padding: 0.5rem;
      margin-bottom: 0.5rem;
    }

    .status-bar {
      display: flex;
      justify-content: space-between;
      padding: 0.2rem 0.5rem;
      background: #ece9d8;
      font-size: 0.8rem;
    }

    /* Zone de jeu */
    #gameArea {
      position: relative;
      background: #d4d0c8;
      border: 2px inset #fff;
      height: 200px;
      overflow: hidden;
      margin-bottom: 0.5rem;
    }

    .target {
      position: absolute;
      font-size: 2rem;
      cursor: pointer;
      user-select: none;
      transition: transform 0.1s ease;
    }

    .target:active {
      transform: scale(0.8);
    }

    /* Bo√Æte de dialogue r√©compense */
    .dialog {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      z-index: 10;
    }
  </style>
</head>
<body>

  <div class="window">
    <div class="title-bar">
      <div class="title-bar-text">XP Search & Game</div>
    </div>

    <!-- Menu -->
    <div class="menu-bar">
      <button class="menu-item">Fichier</button>
      <button class="menu-item">√âdition</button>
      <button class="menu-item">Aide</button>
    </div>

    <div class="window-body">
      <input type="text" id="searchInput" placeholder="Recherche Google‚Ä¶" autofocus>
      <h1 class="rainbow-text" id="Strategy">Hello</h1>

      <div class="btn-center">
        <button id="newWordBtn" class="xp-button">Nouvelle id√©e</button>
        <button id="surpriseBtn" class="xp-button">Surprise</button>
        <button id="startGameBtn" class="xp-button">Jouer</button>
      </div>

      <div id="log"></div>

      <!-- Zone de jeu -->
      <div id="gameArea"></div>
    </div>

    <!-- Barre d'√©tat -->
    <div class="status-bar">
      <span id="score">Score: 0</span>
      <span id="timer">Temps: 0s</span>
      <span id="clock"></span>
    </div>
  </div>

  <script>
    const searchInput = document.getElementById('searchInput');
    const strategyEl = document.getElementById('Strategy');
    const newWordBtn = document.getElementById('newWordBtn');
    const surpriseBtn = document.getElementById('surpriseBtn');
    const logEl = document.getElementById('log');
    const clockEl = document.getElementById('clock');
    const startGameBtn = document.getElementById('startGameBtn');
    const gameArea = document.getElementById('gameArea');
    const scoreEl = document.getElementById('score');
    const timerEl = document.getElementById('timer');

    const strategies = ["chaton", "loutre", "canard", "panda roux", "axolotl", "manchot empereur"];

    let score = 0;
    let gameInterval;
    let timeLeft;
    let timerInterval;

    function logAction(text) {
      const time = new Date().toLocaleTimeString();
      logEl.innerHTML += `[${time}] ${text}<br>`;
      logEl.scrollTop = logEl.scrollHeight;
    }

    function setRandomStrategy() {
      const choice = strategies[Math.floor(Math.random() * strategies.length)];
      strategyEl.textContent = choice;
      logAction(`Mot choisi : ${choice}`);
    }

    searchInput.addEventListener('keydown', e => {
      if (e.key === 'Enter') {
        const query = searchInput.value.trim();
        if (query) {
          window.open(`https://www.google.com/search?q=${encodeURIComponent(query)}`, '_blank');
          logAction(`Recherche : ${query}`);
        }
      }
    });

    newWordBtn.addEventListener('click', setRandomStrategy);

    surpriseBtn.addEventListener('click', () => {
      let count = 0;
      const interval = setInterval(() => {
        setRandomStrategy();
        count++;
        if (count >= 5) clearInterval(interval);
      }, 2000);
      logAction("Mode surprise activ√© !");
    });

    function updateClock() {
      clockEl.textContent = new Date().toLocaleTimeString();
    }
    setInterval(updateClock, 1000);
    updateClock();

    // Mini-jeu
    function startGame() {
      score = 0;
      timeLeft = 20;
      scoreEl.textContent = `Score: ${score}`;
      timerEl.textContent = `Temps: ${timeLeft}s`;
      logAction("Jeu d√©marr√© !");
      gameArea.innerHTML = "";

      gameInterval = setInterval(spawnTarget, 1000);
      timerInterval = setInterval(() => {
        timeLeft--;
        timerEl.textContent = `Temps: ${timeLeft}s`;
        if (timeLeft <= 0) endGame();
      }, 1000);
    }

    function spawnTarget() {
      const target = document.createElement("div");
      target.classList.add("target");
      target.textContent = "üê±";

      const maxX = gameArea.clientWidth - 40;
      const maxY = gameArea.clientHeight - 40;
      target.style.left = Math.random() * maxX + "px";
      target.style.top = Math.random() * maxY + "px";

      target.addEventListener("click", () => {
        score++;
        scoreEl.textContent = `Score: ${score}`;
        target.remove();
      });

      gameArea.appendChild(target);
      setTimeout(() => target.remove(), 1000);
    }

    function endGame() {
      clearInterval(gameInterval);
      clearInterval(timerInterval);
      logAction(`Jeu termin√© ! Score final : ${score}`);
      showRewardDialog();
    }

    function showRewardDialog() {
      const dialog = document.createElement("div");
      dialog.classList.add("window", "dialog");
      dialog.innerHTML = `
        <div class="title-bar">
          <div class="title-bar-text">F√©licitations</div>
        </div>
                <div class="window-body">
          <p>Bravo‚ÄØ! Ton score final est de <strong>${score}</strong> points.</p>
          <p>${score >= 10 
              ? "Incroyable‚ÄØ! Tu es un vrai chasseur de chatons üèÜ" 
              : "Pas mal‚ÄØ! Tu peux encore t'am√©liorer üòâ"}</p>
          <div style="text-align:center; margin-top:1rem;">
            <button class="xp-button" id="closeDialogBtn">OK</button>
          </div>
        </div>
      `;
      document.body.appendChild(dialog);

      // Fermer la bo√Æte de dialogue
      document.getElementById("closeDialogBtn").addEventListener("click", () => {
        dialog.remove();
      });
    }

    startGameBtn.addEventListener('click', startGame);

    // Initialisation
    setRandomStrategy();
  </script>

</body>
</html>